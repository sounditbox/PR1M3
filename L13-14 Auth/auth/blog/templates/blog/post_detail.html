{% extends 'blog/base.html' %}

{% block content %}
<main class="container py-4">

    <div class="card shadow-sm mb-5">
        <div class="card-body">
            <h1 class="card-title">{{ post.title }}</h1>
            <p class="card-subtitle mb-2 text-muted">
                <a href="{% url 'blog:author_detail' post.author.id %}">{{ post.author }}</a>
            </p>
            <p class="card-subtitle mb-2 text-muted">
                {{ post.created_at }}
            </p>
            <p class="card-subtitle mb-2 text-muted">
                –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ post.category.title }}
            </p>
            <p class="card-subtitle mb-2 text-muted">
                {% for tag in post.tags.all %}
                    {{ tag.title }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </p>

            <div class="mt-4 d-flex ">
                <p>üëÄ: {{ post.annotated_views }}</p>
            </div>
            {% if post.image %}
            <div class="mt-4 d-flex">
                 <img src="{{ post.image.url }}" alt="image" width="1000">
            </div>
            {% endif %}

            <p class="card-text mt-3 py-3">
                {{ post.content }}
            </p>
            <div class="mt-4 d-flex gap-2">
                <a href="{% url 'blog:post_list' %}" class="btn btn-secondary">
                    ‚Üê –í—Å–µ –º–æ–¥–µ–ª–∏
                </a>
                {% if user.is_authenticated  %}
                <button onclick="window.location.href='{% url 'blog:post_delete' post.id %}'"
                        class="btn btn-outline-danger" type="submit">–£–¥–∞–ª–∏—Ç—å
                </button>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å —Ñ–æ—Ä–º–æ–π —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    {% if user.is_authenticated  %}
    <div class="card shadow-sm">
        <button class="btn btn-primary" type="button"
                onclick="window.location.href='{% url 'blog:post_edit' post.id %}'">
            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
        </button>
    </div>
    {% endif %}

    <div class="card shadow-sm mt-4">
        {% if user.is_authenticated  %}
            {% include 'blog/comment_create.html' %}
        {% else %}
            <div class="card-body">
                <p>–ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ÃÜ, <a href="{% url 'users:login' %}">–≤–æ–∏ÃÜ–¥–∏—Ç–µ</a></p>
            </div>
        {% endif %}
        <div class="card-body">
            <h2 class="card-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h2>
            {% for comment in post.comments.all %}
                <div class="card shadow-sm mb-3">
                    <div class="card-body">
                        <p class="card-subtitle mb-2 text-muted">
                            {{ comment.author }}
                        </p>
                        <h4 class="card-text">{{ comment.content }}</h4>
                        <p class="card-subtitle mb-2 text-muted">
                            {{ comment.created_at }}
                        </p>
                        <button onclick="window.location.href='{% url 'blog:comment_delete' post.id comment.id %}'"
                                class="btn btn-outline-danger" type="submit">–£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            {% empty %}
                <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</p>
            {% endfor %}
        </div>
    </div>

</main>
{% endblock %}
